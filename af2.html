<html>
  <head>
    <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
    <script src="https://sdk.altvr.com/libs/altspace.js/2.8.0/altspace.min.js"></script>
    <script src="https://unpkg.com/aframe-physics-system@1.4.0/dist/aframe-physics-system.min.js"></script>
    <script src="js/foo-component.js"></script>
  </head>
  <body>
    <a-scene altspace='vertical-align: bottom;'>
         <!-- preload all our textures -->
    <a-assets>
        <img id='card_back_texture' src='images/back.jpg'/>
        <img id='major' src='images/Rider-Waite-Smith_deck.png'/>
       <!-- <img id='minor' src='images/Rider-Waite-Smith_deck.png'/>-->
    </a-assets>
             <a-entity hello-world></a-entity>
            <a-entity  id="_1"  position="0 1 0"   rotation="90 0 0" class="tarot_card">
            <a-entity  geometry="primitive: plane;height: .5; width:.25" position="0 0 -.001" material="side: double;src:#card_back_texture; repeat: 1 1"></a-entity>             
            <a-entity id="the_moon" geometry="primitive: plane;height: .5; width:.25" position="0 0 0" material="side: double;src:#major; repeat: .165 .25;offset: 0 0;"></a-entity>
            
            <a-animation id="pp2" attribute="rotation"
            dur="5000"
            fill="forwards"
            to="-90 0 0"
            repeat="0" begin="poopevent" delay="0"></a-animation>
          </a-entity>
     
            <a-entity  id="_2"  position=".4 1 0"   rotation="90 0 0" class="tarot_card">
                <a-entity  geometry="primitive: plane;height: .5; width:.25" position="0 0 -.001" material="side: double;src:#card_back_texture; repeat: 1 1"></a-entity>             
                <a-entity id="the_sun" geometry="primitive: plane;height: .5; width:.25" position="0 0 0" material="side: double;src:#major; repeat: .165 .25; offset: .165 0;"></a-entity>
               <!--
                <a-animation attribute="rotation"
                dur="5000"
                fill="forwards"
                to="-90 0 0"
                repeat="indefinite" direction="alternate"></a-animation>
               -->  
               <a-animation id="roto_ani" attribute="rotation"
                    dur="5000"
                    fill="forwards"
                    to="-90 0 0"
                    repeat="0" direction="forward"></a-animation>
                <a-animation attribute="position"
                dur="5000"
                fill="both"
                from=".4 2 0"
                to=".4 1 0"
                repeat="0" direction="forward"></a-animation>
                <!--
                <a-animation attribute="position"
                dur="5000"
                fill="both"
                from=".4 1 0"
                to=".4 3 0"
                repeat="indefinite" direction="reverse"></a-animation>
                -->
              </a-entity>
<!--
            <a-entity box="width: 0.5; height: 0.25; depth: 1; color: orange"
            position="0 2 0"></a-entity>
-->
    </a-scene>
    <script>
//console.log(document.querySelector('#roto_ani').sceneEl.object3D);
var sceneEl = document.querySelector('a-scene');
      //sceneEl.querySelector('.tarot_card').setAttribute('rotation', '90 0 0');
      var roto_ani2 = sceneEl.querySelector('#_2');

roto_ani.addEventListener('animationend', function (event) {
  console.log('ani started', event.srcElement.id);
  pp2.emit('poopevent', 'text', true);
});

pp2.addEventListener('poopevent', function (event) {
  console.log('poop!', event);
 
});
/**/
    </script>
  </body>
</html>